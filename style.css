/*
Theme Name: G2RD Theme
Theme URI: https://g2rd.fr/themes/g2rd-agence-web
Author: Sebastien GERARD
Author URI: https://g2rd.fr
Copyright: © 2025 Sebastien GERARD
Description: Un thème Full Site Editing (FSE) moderne et flexible pour les agences web. Ce thème offre une expérience d'édition complète avec des blocs personnalisés, des animations fluides et une interface intuitive. Idéal pour les sites vitrines, portfolios et sites d'agences web.
Requires at least: 6.5
Tested up to: 6.5
Requires PHP: 8.0
 Version: 1.1.6
License: GPL-2.0-or-later
License URI: http://www.gnu.org/licenses/gpl-2.0.html
Text Domain: g2rd-theme
Tags: full-site-editing, editor-style, block-styles, wide-blocks, custom-colors, custom-menu, custom-logo, featured-images, footer-widgets, portfolio, blog, translation-ready, rtl-language-support, threaded-comments, accessibility-ready

GitHub Theme URI: https://github.com/SebG2RD/G2RD-Theme-FSE
*/

/*
  1.1.6 – Corrections de sécurité et conformité WordPress.org
  - Correction du conflit de licence : Uniformisation GPL-2.0-or-later dans tous les fichiers
  - Nettoyage du code JavaScript : Suppression de 17 console.log() dans les fichiers de production
  - Amélioration de l'échappement des données : Correction dans class-theme-admin.php et class-surecart-license-manager.php
  - Sécurisation des attributs Data : Création de la fonction safeJsonEncode() pour encoder de manière sécurisée
  - Amélioration du logo dans la barre d'administration : Correction de l'affichage et ajustement de la taille (100px)
  - Optimisations de sécurité : Utilisation correcte de esc_url(), esc_attr(), esc_html(), esc_js()

  1.1.5 – Nouveau bloc G2RD Accordéon FAQ et nouveaux blocs
  - Création d'un bloc accordéon complet pour créer des FAQ avec onglets ouvrables/fermables
  - Ajout/suppression illimitée d'items (onglets) avec boutons d'ajout/suppression
  - Compteur d'onglets personnalisable (gauche/droite) avec style personnalisable
  - Modification des titres avec RichText pour éditer directement dans l'éditeur
  - Choix de l'icône : 4 types disponibles (chevron, flèche, flèche horizontale, plus/moins) avec position personnalisable (gauche/droite)
  - Choix de l'état initial : tout ouvert, tout fermé, ou premier ouvert au chargement
  - Support de plusieurs items ouverts simultanément ou un seul à la fois
  - Contenu riche avec InnerBlocks pour chaque item (n'importe quel bloc WordPress natif ou personnalisé)
  - Personnalisation complète : couleurs (items actifs/inactifs, contenu), bordures (couleur, épaisseur, rayon), espacement entre items
  - Design responsive : adaptation automatique pour mobile et tablette avec styles optimisés
  - Accessibilité : support ARIA complet (aria-expanded, aria-controls, role="region") pour les lecteurs d'écran
  - Script frontend : interactivité complète avec gestion des états ouverts/fermés et mise à jour des icônes
  - Correction du filtre deregisterBlocks : correction pour éviter de bloquer tous les blocs en cas d'erreur ou configuration vide
  - Compilation des blocs : tous les blocs manquants ont été compilés (Counter, Info, Countdown, Typed, Toggle Content, Carousel, Tabs)
  - Nouveau bloc G2RD Onglets (Tabs) : bloc d'onglets personnalisable avec contenu riche dans chaque onglet
  - Nouveau bloc G2RD Modal (Popup) : fenêtre modale avec bouton déclencheur, contenu riche, options de style complètes et contrôle d'alignement
  - Nouveau bloc G2RD Marquee : défilement infini horizontal ou vertical avec effet de fondu, permet d'ajouter n'importe quel contenu

  1.1.4 – Simplification et optimisation du bloc G2RD Carousel
  - Simplification de la configuration du loop pour améliorer la stabilité
  - Désactivation automatique du loop si nombre de slides insuffisant
  - Configuration simplifiée des breakpoints responsive
  - Suppression des messages de debug dans la console
  - Optimisation du code JavaScript pour réduire la complexité
  - Amélioration de la gestion de l'autoplay avec loop désactivé sur desktop
  - Correction des problèmes de décalage avec l'effet coverflow

  1.1.3 – Gestion des CPT depuis la page de licence
  - Ajout de toggles pour activer/désactiver chaque CPT (Prestations, Qui sommes-nous, Portfolio)
  - Ajout de champs pour personnaliser le nom de chaque CPT
  - Sauvegarde AJAX des états et noms avec feedback visuel
  - Interface améliorée utilisant les classes WordPress natives (postbox, card, etc.)
  - Mise en page flexbox pour afficher les cartes CPT en ligne
  - Ajout d'icônes Dashicons et animations de chargement
  - Footer avec informations de contact (g2rd.fr et email)
  - Styles responsive pour adaptation mobile

  1.1.2 – Améliorations du bloc G2RD Carousel
  - Mobile (<768px) : affichage fixe 2×2 (4 images) sans autoplay, sans loop, sans swipe,
    sans pagination/navigation. Effet forcé « slide » pour éviter les artefacts 3D.
  - Desktop/Tablette : comportement intact (effets, autoplay et loop selon réglages).
  - Respect strict de « Show Captions » : l'overlay .carousel-post-info n'est plus rendu quand
    l'option est désactivée.
  - Robustesse front : fallback si le HTML n'a pas de slides (contentData/contentIds dans
    data-config + récupération REST si besoin).
  - CSS mobile : neutralise les largeurs 33.33% pour forcer 2×2 (50%).
*/

/* Logo TranslatePress plugin */
.trp-language-switcher > div {
  background-color: transparent !important;
}
.trp-language-switcher > div > a {
  color: var(--wp--preset--color--secondary) !important;
}

ul {
  list-style: none;
}

/* Erreur avec l'activation de surecart */
.wp-block-buttons {
  width: auto !important;
}

/* Animation de découverte */
@keyframes reveal {
  from {
    opacity: 0;
    translate: 0 100px;
  }
  to {
    opacity: 1;
    translate: 0 0;
  }
}

.scroll-animation {
  animation: reveal linear both;
  animation-timeline: view(block);
  animation-range: cover -10% cover 25%;
}

/* Barre de cookies */

.seopress-user-consent {
  height: 20%;
}

.seopress-user-consent button {
  padding: 1rem 2rem;
}

/* Visuel article */
.img-h-100 {
  height: 100%;
  width: 100%;
}

/* Variables globales */
:root {
  --transition-standard: 0.2s ease;
  --transition-slow: 0.5s ease;
  --z-index-base: 1;
  --z-index-links: 2;
  --z-index-buttons: 2;
  --z-index-overlay: 3;
}

/* Styles communs pour les articles et portfolios */
.h-article,
.portfolio {
  height: 100%;
  box-shadow: var(--wp--preset--shadow--huge);
  transition: transform var(--transition-standard);

  position: relative;
  cursor: pointer;
  overflow: hidden;
  z-index: var(--z-index-base);
}

/* Effets de survol communs */
.h-article:hover,
.portfolio:hover {
  transform: translateY(-2px);
  box-shadow: var(--wp--preset--shadow--huge);
}

.g2rd-clickable-article {
  position: relative;
  cursor: pointer;
  overflow: hidden;
  z-index: var(--z-index-base);
  height: 100%;
}

/* Image prestation */
.resize-img {
  width: 30%;
}

/* Styles communs pour les images */
.h-article img,
.portfolio img,
.g2rd-clickable-article img {
  transition: transform var(--transition-slow);
}

.h-article:hover img,
.portfolio:hover img,
.g2rd-clickable-article:hover img {
  transform: scale(1.05);
}

/* Styles spécifiques pour les éléments cliquables */
.g2rd-clickable-article {
  cursor: pointer !important;
}

/* Gestion des z-index pour les éléments cliquables */
.g2rd-clickable-article::after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: var(--z-index-base);
  pointer-events: none;
}

.g2rd-clickable-article * {
  position: relative;
  z-index: 0;
}

.g2rd-clickable-article a {
  position: relative;
  z-index: var(--z-index-links);
}

.g2rd-clickable-article button {
  position: relative;
  z-index: var(--z-index-buttons);
}

/* Styles pour les blocs avec l'option clickableArticles */
[data-clickable-articles="true"] {
  position: relative;
}

[data-clickable-articles="true"] .g2rd-clickable-article {
  position: relative;
  z-index: var(--z-index-base);
}

/* Suppression de l'ancien effet de particules avec radial-gradient */
[data-particles="true"]::after {
  display: none;
}

/* Style pour les noeuds (points) du réseau */
[data-particles="true"] .node {
  position: absolute;
  background: #cccccc;
  border-radius: 50%;
  width: 2.5px;
  height: 2.5px;
  opacity: 0.7;
  z-index: -1;
  transition: transform 0.15s ease-out, opacity 0.15s ease-out;
  will-change: transform, left, top;
}

/* Style pour les lignes connectant les noeuds */
[data-particles="true"] .line {
  position: absolute;
  background: #cccccc;
  height: 0.5px;
  transform-origin: 0 0;
  opacity: 0.3;
  z-index: -1;
  transition: opacity 0.2s ease;
  will-change: transform, width, opacity;
}

/* Z-index pour les particules et conteneurs */
.particles-container {
  z-index: 0;
  position: relative;
}

/* Assurer que le contenu du bloc est au-dessus des particules */
[data-particles="true"] > *:not(.node):not(.line):not(.particle) {
  position: relative;
  z-index: 1;
}

/* Effet de survol au niveau du conteneur parent */
[data-particles="true"]:hover .node {
  opacity: 0.9;
}

[data-particles="true"]:hover .line {
  opacity: 0.6;
}

/* Effet de particules pour les éléments avec data-particles=true */
[data-particles="true"] {
  position: relative;
  overflow: hidden;
}

[data-particles="true"]::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -2;
}

/* Animation des particules */
@keyframes particle-float {
  0% {
    transform: translateY(0) translateX(0);
    opacity: 0;
  }
  20% {
    opacity: 0.8;
  }
  100% {
    transform: translateY(-100px) translateX(30px);
    opacity: 0;
  }
}

@media (max-width: 768px) {
  .groupe-flex {
    flex-direction: column;
  }
  .responsive-group {
    padding: 0.5rem;
  }
  .wp-block-group-is-layout-flex {
    flex-direction: column;
  }
  .wp-container-core-social-links-is-layout-d445cf74 {
    justify-content: center;
  }
  li.wp-social-link {
    width: 10%;
  }

  /* Adaptation du CSS pour la verision mobile */
  .ti-widget {
    width: 100% !important;
  }
}

/* Effet de verre */
[data-glass="true"] {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 16px;
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

/* Support pour les navigateurs qui ne supportent pas backdrop-filter */
@supports not (backdrop-filter: blur(5px)) {
  [data-glass="true"] {
    background: rgba(255, 255, 255, 0.8);
  }
}

/*
 * Depuis la version 1.0.8, l'effet particules est automatiquement désactivé pour Google PageSpeed Insights et Lighthouse afin d'améliorer le score de performance.
 */
